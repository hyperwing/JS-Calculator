<!-- File Created 10/16/2019 by Neel Mansukhani -->
<!-- Edited 10/17/2019 by Neel Mansukhani: Added number input events -->
<!-- Edited 10/17/2019 by Sri Ramya Dandu: Added memory buttons and logic for clear,recall, and display-->
<!-- Edited 10/18/2019 by Neel Mansukhani: Added operators -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Use the title from a page's frontmatter if it has one -->
    <title>Javascript Calculator</title>
    <link rel="stylesheet" type="text/css" href="calculator.css">
  </head>
  <body>
    <table class="calculator">
        <tr>
            <td id="calculations" colspan="4"></td>
        </tr>
        <tr>
            <td id="display" colspan="4">0</td> 
        </tr>

        <tr>
            <td><button onclick="memoryClear([4,6,2])">MC</button></td>
            <td><button onclick="memoryRecall([4,6,2])">MR</button></td>
            <td><button>MS</button></td>
            <td>
                <button onclick="displayMemory([4,6,2])">M&#9660;</button>
                <div id="display-memory-list">
                    <p id = "memory-stack-display"></p>
                </div>
            </td>
        </tr>
        <tr>
            <td><button>CE</button></td>
            <td><button>C</button></td>
            <td><button onclick="onSimpleButtonClick('DEL')">DEL</button></td>
            <td><button class="div-by-zero" onclick="onOperationButtonClick('/')">/</button></td>
        </tr>
        <tr>
            <td><button onclick="onSimpleButtonClick('7')">7</button></td>
            <td><button onclick="onSimpleButtonClick('8')">8</button></td>
            <td><button onclick="onSimpleButtonClick('9')">9</button></td>
            <td><button class="div-by-zero" onclick="onOperationButtonClick('*')">*</button></td>
        </tr>
        <tr>
            <td><button onclick="onSimpleButtonClick('4')">4</button></td>
            <td><button onclick="onSimpleButtonClick('5')">5</button></td>
            <td><button onclick="onSimpleButtonClick('6')">6</button></td>
            <td><button class="div-by-zero" onclick="onOperationButtonClick('-')">-</button></td>
        </tr>
        <tr>
            <td><button onclick="onSimpleButtonClick('1')">1</button></td>
            <td><button onclick="onSimpleButtonClick('2')">2</button></td>
            <td><button onclick="onSimpleButtonClick('3')">3</button></td>
            <td><button class="div-by-zero" onclick="onOperationButtonClick('+')">+</button></td>
        </tr>
        <tr>
            <td><button class="div-by-zero" onclick="onSimpleButtonClick('+/-')">+/-</button></td>
            <td><button onclick="onSimpleButtonClick('0')">0</button></td>
            <td><button class="div-by-zero" onclick="onSimpleButtonClick('.')">.</button></td>
            <td><button onclick="onEqualClick()">=</button></td>
        </tr>                         
    </table>
  </body>
</html>


<script type="text/javascript">
var display = "0";
var lastButtonOperator = false;
var calculations = [];
var calcValue = 0;
var memory = [];
var history = [];
var buttonState = true;
// TODO: set buttonState to true when =, CE, or C are pressed.
// Created 10/17/2019 by Neel Mansukhani
// Number button clicks are registered here then display is updated.
function onSimpleButtonClick(symbol) {
    if(lastButtonOperator) {
        if(symbol == ".") {
            display = "0.";
            lastButtonOperator = false;
        } else if(symbol == "+/-") {
            if(display.charAt(0) == '-') {
                display = display.substr(1);
            } else {
                display = "-" + display;
            }            
        } else if(!isNaN(symbol)) {
            buttonState = true;
            display = symbol;
            lastButtonOperator = false;
        } else {
            if(!buttonState) {
                buttonState = true;
                display = "0"
                lastButtonOperator = false;            
            }
        }
        
    } else {
        if(symbol == "+/-" && display != "0") {
            if(display.charAt(0) == '-') {
                display = display.substr(1);
            } else {
                display = "-" + display;
            }
        } else if (symbol == "DEL") {
            if(!buttonState) {
                buttonState = true;
                display = "0"
            }            
            if(display != "0") {
                display = display.substr(0, display.length - 1);
                if(display.length == 0 || display == "-") {
                    display = "0";
                }
            }    
        } else if(!isNaN(symbol)) {
            if(!buttonState) {
                buttonState = true;
                display = "0"
            }
            if(display == "0") {
                display = symbol;
            } else {
                display += symbol;
            }
        }
    }
    updateDisplay();
}

// Created 10/17/2019 by Neel Mansukhani
// Updates the display after new calculations.
function updateDisplay() {
    document.getElementById("display").innerHTML = display;
    document.getElementById("calculations").innerHTML = calculations.toString().replace(/,/g," ");
    // document.getElementById("memory").innerHTML = memory;
    // document.getElementById("history").innerHTML = history;
    setButtonState(buttonState);
}

// Created 10/17/2019 by Neel Mansukhani
// Operation button clicks are registered here then display is updated.
function onOperationButtonClick(operation) {
    if(isOperator(calculations[calculations.length - 1]) && lastButtonOperator) {
        calculations[calculations.length - 1] = operation;
    } else {
        calculations.push(parseFloat(display));
        calculations.push(operation);
        display = calculateCalculations();
        
            
    }
    lastButtonOperator = true;
    updateDisplay();
}
// Created 10/17/2019 by Neel Mansukhani
// Returns whether the given parameter is an operator.
function isOperator(input) {
    return input == "+" || input == "-" || input == "*" || input == "/";
}

// Created 10/17/2019 by Neel Mansukhani
// Does all of the math in the calculations array.
function calculateCalculations() {
    var calcValue;
    if(calculations.length < 3) {
        calcValue = parseFloat(display);
    } else {     
        calcValue = doMath(calculations[0], calculations[2], calculations[1]);
        if(typeof calcValue == "string") {
            return calcValue;
        }
        for(var i = 3; i < calculations.length; i++) {
            if(i % 2 == 1) {
                operator = calculations[i];
            } else {
                calcValue = doMath(calcValue, calculations[i],operator);
                if(typeof calcValue == "string") {
                    return calcValue;
                }        
            }

        }
    }
    return calcValue;
}

// Created 10/17/2019 by Neel Mansukhani
// Does math between two numbers based on the given operator.
function doMath(num1, num2, operator) {
    var value = 0;
    switch(operator) {
            case "+":
                value = num1 + num2;
                break;
            case "-":
                value = num1 - num2;
                break;
            case "*":
                value = num1 * num2;
                break;
            case "/":
                if(num2 == 0) {
                    if(num1 == 0) {
                        value = "Result is undefined";
                    } else {
                        value = "Cannot divide by zero";
                    }
                    buttonState = false;
                    calculations = [];
                } else {
                    value = num1 / num2;  
                }
                break;
        }
    return value; 
}

// Created 10/17/2019 by Neel Mansukhani
// Disables or enables buttons as a result of divide by zero.
function setButtonState() {
    var buttons = document.getElementsByClassName("div-by-zero");
    for(var i = 0; i < buttons.length; i++) {
        buttons[i].disabled = !buttonState;
    }    
}


// Created 10/17/2019 by Sri Ramya Dandu
// Clears all the values stored in memory, sets the memory to 0
function clearMemory(memoryStack, currentDisplay){
    memoryStack.length = 0;
    currentDisplay = 0;
    return memoryStack;
}

// Created 10/17/2019 by Sri Ramya Dandu
// Uses the number in memory as the current value 
function memoryRecall(memoryStack){
    display = memoryStack[0];
    hideMemory();
    updateDisplay();
}

// Created 10/17/2019 by Sri Ramya Dandu
// Shows the list of numbers in memory 
function displayMemory(memoryStack){
    var htmlCode = "";
    memoryStack.forEach(function(element) {
        htmlCode += '<button class= "memory-list" onclick="memoryRecall([' + element+ '])">' + element + "</button><br/>"
    });

    document.getElementById("memory-stack-display").innerHTML = htmlCode;
    document.getElementById('display-memory-list').style.display = "block";
}

// Created 10/17/2019 by Sri Ramya Dandu
// Hides the list of numbers in memory 
function hideMemory(){
    document.getElementById('display-memory-list').style.display = "none";
}

</script>